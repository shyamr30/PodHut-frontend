{"ast":null,"code":"import _asyncToGenerator from\"E:\\\\College Assignment\\\\Sem 6\\\\SDP Project\\\\project\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _slicedToArray from\"E:\\\\College Assignment\\\\Sem 6\\\\SDP Project\\\\project\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import _regeneratorRuntime from\"E:\\\\College Assignment\\\\Sem 6\\\\SDP Project\\\\project\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React from'react';import Card from'../../../components/shared/Card/Card';import Button from'../../../components/shared/Button/Button';import styles from'./StepAvatar.module.css';import{useDispatch,useSelector}from'react-redux';import{useState}from'react';import{setAvatar}from'../../../store/activateSlice';import{activate}from'../../../http';import{setAuth}from'../../../store/authSlice';import Loader from'../../../components/shared/Loader/Loader';import{useEffect}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var StepAvatar=function StepAvatar(_ref){var onNext=_ref.onNext;var dispatch=useDispatch();var _useSelector=useSelector(function(state){return state.activate;}),name=_useSelector.name,avatar=_useSelector.avatar;var _useState=useState('/images/monkey-avatar.png'),_useState2=_slicedToArray(_useState,2),image=_useState2[0],setImage=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),unMounted=_useState6[0],setUnMounted=_useState6[1];function captureImage(e){var file=e.target.files[0];var reader=new FileReader();reader.readAsDataURL(file);reader.onloadend=function(){console.log(reader.result);setImage(reader.result);dispatch(setAvatar(reader.result));};}function submit(){return _submit.apply(this,arguments);}function _submit(){_submit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$activate,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(!name||!avatar)){_context.next=2;break;}return _context.abrupt(\"return\");case 2:setLoading(true);_context.prev=3;_context.next=6;return activate({name:name,avatar:avatar});case 6:_yield$activate=_context.sent;data=_yield$activate.data;if(data.auth){if(!unMounted){dispatch(setAuth(data));}}_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](3);console.log(_context.t0);case 14:_context.prev=14;setLoading(false);return _context.finish(14);case 17:case\"end\":return _context.stop();}}},_callee,null,[[3,11,14,17]]);}));return _submit.apply(this,arguments);}useEffect(function(){return function(){setUnMounted(true);};});if(loading)return/*#__PURE__*/_jsx(Loader,{message:\"Activation in progress...\"});return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Card,{title:\"Okay, \".concat(name),icon:\"monkey-emoji\",children:[/*#__PURE__*/_jsx(\"p\",{className:styles.subHeading,children:\"How's this photo?\"}),/*#__PURE__*/_jsx(\"div\",{className:styles.avatarWrapper,children:/*#__PURE__*/_jsx(\"img\",{className:styles.avatarImage,src:image,alt:\"avatar\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{onChange:captureImage,id:\"avatarInput\",type:\"file\",className:styles.avatarInput}),/*#__PURE__*/_jsx(\"label\",{className:styles.avatarLabel,htmlFor:\"avatarInput\",children:\"Choose a different photo\"})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Button,{onClick:submit,text:\"Next\"})})]})});};export default StepAvatar;","map":{"version":3,"sources":["E:/College Assignment/Sem 6/SDP Project/project/frontend/src/pages/Steps/StepAvatar/StepAvatar.jsx"],"names":["React","Card","Button","styles","useDispatch","useSelector","useState","setAvatar","activate","setAuth","Loader","useEffect","StepAvatar","onNext","dispatch","state","name","avatar","image","setImage","loading","setLoading","unMounted","setUnMounted","captureImage","e","file","target","files","reader","FileReader","readAsDataURL","onloadend","console","log","result","submit","data","auth","subHeading","avatarWrapper","avatarImage","avatarInput","avatarLabel"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport Card from '../../../components/shared/Card/Card';\r\nimport Button from '../../../components/shared/Button/Button';\r\nimport styles from './StepAvatar.module.css';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { useState } from 'react';\r\nimport { setAvatar } from '../../../store/activateSlice';\r\nimport { activate } from '../../../http';\r\nimport { setAuth } from '../../../store/authSlice';\r\nimport Loader from '../../../components/shared/Loader/Loader';\r\nimport { useEffect } from 'react';\r\n\r\nconst StepAvatar = ({onNext}) => {\r\n  const dispatch = useDispatch();\r\n  const {name, avatar} = useSelector((state) => state.activate);\r\n  const [image, setImage] = useState('/images/monkey-avatar.png');\r\n  const [loading, setLoading] = useState(false);\r\n  const [unMounted, setUnMounted] = useState(false);\r\n\r\n  function captureImage(e) {\r\n    const file = e.target.files[0];\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(file);\r\n    reader.onloadend = function () {\r\n      console.log(reader.result);\r\n      setImage(reader.result);\r\n      dispatch(setAvatar(reader.result));\r\n    };\r\n  }\r\n\r\n  async function submit() {\r\n    if(!name || !avatar) return;\r\n    setLoading(true);\r\n    try {\r\n      const { data } = await activate({name, avatar});\r\n      if(data.auth) {\r\n        if (!unMounted) {\r\n          dispatch(setAuth(data));\r\n      }\r\n      }\r\n    } catch(err) {\r\n        console.log(err);\r\n    }\r\n    finally{\r\n      setLoading(false);\r\n    }\r\n\r\n  }\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      setUnMounted(true);\r\n    }\r\n  })\r\n\r\n  if(loading) return <Loader message=\"Activation in progress...\" />;\r\n\r\n    return (\r\n        <>\r\n          <Card  \r\n              title={`Okay, ${name}`}\r\n              icon=\"monkey-emoji\"\r\n            >\r\n              <p className={styles.subHeading}>How's this photo?</p>\r\n              \r\n              <div className={styles.avatarWrapper}>\r\n                <img className={styles.avatarImage} src={image} alt=\"avatar\"/>\r\n              </div>\r\n\r\n              <div>\r\n                <input\r\n                 onChange={captureImage}\r\n                 id=\"avatarInput\" \r\n                 type=\"file\" \r\n                 className={styles.avatarInput} \r\n                />\r\n\r\n                <label \r\n                  className={styles.avatarLabel} \r\n                  htmlFor=\"avatarInput\">\r\n                  Choose a different photo\r\n                </label>\r\n\r\n              </div>\r\n\r\n              <div >\r\n                <Button onClick={submit} text=\"Next\" />\r\n              </div>\r\n\r\n            </Card>\r\n        </>\r\n      \r\n    );\r\n};\r\n\r\nexport default StepAvatar;\r\n"]},"metadata":{},"sourceType":"module"}